<!doctype html>
<html>
	<head>
	    <!--声明当前页面的编码集：中文编码（gbk/gb2312）,国际编码（utf-8）-->
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
		<!--页面三要素-->
		<title>dialog会话框组件开发Demo</title><!--小于等于31 大小写不区分-->
		<meta name="Keywords" content="关键词,关键词,关键词"><!--<=76个字-->
		<meta name="description" content=""><!--<=80个字-->
		<!--js/css-->
		<link rel="stylesheet" href="../../../js/bootstrap/bootstrap.css">
		<link rel="stylesheet" href="../../../css/common.css">
	</head>  
	<body class="gray-bg">
		<div class="container">
			<h2 class="page-header">图片预览(点击图片进行预览)</h2>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="panel  panel-default">
					<div class="panel-body text-center">
						<img data-view="true" src="loading.gif" />
					</div>
				</div>
			</div>
			
		
		</div>
		<script type="text/javascript" src="jquery.js" ></script>
		<script src="img.js"></script>
		<script>
			$(function(){
				
				$.getJSON("http://www.wookmark.com/api/json/popular?callback=?",function(data){
					var imgindex=0;
					var index=0;
							function loadImageAsync(dom,index,imgindex,data) {
							  return new Promise(function(resolve, reject) {
							  	if($("img").eq(imgindex)[0]){
								  	dom.src=data[index].preview;
								    dom.onload = function() {
								    	imgindex++;
								    	index++;
								    	if(index>=50){
								    		index=0;
								    	}
							    		loadImageAsync($("img").eq(imgindex)[0],index,imgindex,data);
								    };
								    dom.onerror = function() {
								    	index++;
								    	if(index>=50){
								    		index=0;
								    	}
								      loadImageAsync($("img").eq(imgindex)[0],index,imgindex,data);
								    };
								  }else{
								  	return false
								  }
							  });
							}
							
							loadImageAsync($("img").eq(imgindex)[0],index,imgindex,data).then(function(a,b){
								return true;
							},function(dom,index){
								return true;
							});
				});
			});
		</script>
	</body>
</html>
