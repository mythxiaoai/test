<!DOCTYPE html>
<html>
  <head>
    <base href="<%=basePath%>">
    
    <title>My JSP 'hmjsonpTest.jsp' starting page</title>
    
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="expires" content="0">    
	<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
	<meta http-equiv="description" content="This is my page">
<script src="../js/jquery.min.js" ></script>
  </head>
  
  <body>
    <button type="button" id="btn">开始测试</button>
    <script>
    	$(function(){
		    	function loadJson(){
						//get请求   
						//jsonpCallback=?一定不能变  jqery做处理了  
						//可以理解成匿名还输指向下面的回调函数  原生的可以自己写函数名
						/*
						$.getJSON("http://localhost/xiaoai_jsonp/index.jsp?id=1111&jsonpCallback=?",
						function(data){
							alert(JSON.stringify(data))
						});
						*/
						//原生jsonp
						//把回调函数根据链接传进去  在服务器端执行
						/*
						var xhr = new XMLHttpRequest();
						xhr.open("get","http://localhost/xiaoai_jsonp/index.jsp?id=1111&jsonpCallback=callback");
						xhr.onreadystatechange=function(){
							if(this.readyState==4&&this.status==200){
							alert(this.responseText);
							eval(this.responseText);
							}
						}
						xhr.send();
						*/
						/*function callback(content){
						alert(JSON.stringify(content))
						}*/
						//jqery
						$.ajax({  
							type : "get",  
							async:false,  
							url : "http://localhost:8080/app/hm/equipment/update.action?key=71754E4154114EF882C92FCFDC7DE0E1&id=a792c1eb6b2f4ba2bf6f5b629ae2d865&siteId=4a33770f75f841fc9a6d12a4e531ecb3&name=挂壁式交流桩&code=004401005003000000&carCode=%231,%232&acDcFlag=1&addr=光谱西路3号",
							dataType : "jsonp",//数据类型为jsonp
							jsonp: "jsonpCallback",//服务端用于接收callback调用的function名的参数  
							success : function(data){  
								console.log(data)
							},  
							error:function(data){  
								console.log(data)
							}  
						});
					}
					$("#btn").click(function(){
						loadJson();
					});
				});
    </script>
  </body>
</html>
